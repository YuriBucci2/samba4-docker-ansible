---

- name: Add samba-tool on host
  ansible.builtin.shell: echo 'docker exec -i samba-pdc samba-tool $*' > /usr/sbin/samba-tool && chmod +x /usr/sbin/samba-tool
  when: inventory_hostname in groups['pdc']

- name: Add samba-tool on host
  ansible.builtin.shell: echo 'docker exec -i samba-dc samba-tool $*' > /usr/sbin/samba-tool && chmod +x /usr/sbin/samba-tool
  when: inventory_hostname in groups['dc']

- name: Add samba-tool on host
  ansible.builtin.shell: echo 'docker exec -i samba-fs samba-tool $*' > /usr/sbin/samba-tool && chmod +x /usr/sbin/samba-tool
  when: inventory_hostname in groups['fileserver']  

- name: Samba | Addons | DNS
  ansible.builtin.include_tasks: dns.yml

- name: Samba | Addons | Fileserver
  ansible.builtin.include_tasks: fileserver.yml

- name: Samba | Addons | Passwords
  ansible.builtin.include_tasks: passwords.yml
  when: inventory_hostname not in groups['fileserver']  

- name: Samba | Addons | Backup
  ansible.builtin.include_tasks: backup.yml

- name: Samba | Addons | Veeam Backup
  ansible.builtin.include_tasks: backup-veeam.yml
  when: SAMBA_VEEAM_BACKUP.ENABLED
